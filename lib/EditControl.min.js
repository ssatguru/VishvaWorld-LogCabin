var org;!function(t){var i,h;i=t.ssatguru||(t.ssatguru={}),function(t){var i,h,s=BABYLON.Axis,n=BABYLON.Color3,u=BABYLON.Matrix,r=BABYLON.Mesh,e=BABYLON.MeshBuilder,l=BABYLON.Path2,f=BABYLON.Quaternion,o=BABYLON.Space,a=BABYLON.StandardMaterial,c=BABYLON.Vector3;(h=i||(i={}))[h.TRANS=0]="TRANS",h[h.ROT=1]="ROT",h[h.SCALE=2]="SCALE";var v=function(){function t(t,i,h,s,n,e){var l=this;this.t=!0,this.i=!1,this.h=!1,this.s=1,this.u=Math.PI/18,this.l=.4,this.o=1,this.v=.02,this.M=.75,this.A=new u,this.L=new c(0,0,0),this.B=2,this.p=new c(0,0,0),this.N=new c(0,0,0),this.O="",this.C=!1,this.g=null,this.R=null,this.S=null,this.T=!1,this.k=!1,this.P=!1,this.j=!1,this.q=new c(0,0,0),this.D=new c(0,0,0),this.F=!1,this.G=new c(0,0,0),this.H=.25,this.I=new c(0,0,0),this.J=new c(0,0,0),this.K=new c(0,0,0),this.U=new c(0,0,0),this.V=!1,this.W=0,this.$=!1,this._=!1,this.tt=!1,this.it=180,this.ht=new c(this.s,this.s,this.s),this.st=new c(0,0,0),this.nt=new c(0,0,0),this.ut=new c(0,0,0),this.rt=new u,this.et=t,this.lt=i,this.ft=h,null!=s&&(this.o=s),this.V=null!==n&&n,this.ot(),null!=e&&(this.v=e),this.at=t.getScene(),this.ct=new M(t,10),t.computeWorldMatrix(!0),this.vt=this.Mt(t),this.wt(t),this.Yt=new r("EditControl",this.at),this.Yt.rotationQuaternion=f.Identity(),this.Yt.visibility=0,this.Yt.isPickable=!1,this.Xt(this.at),this.Zt().parent=this.Yt,this.At().parent=this.Yt,this.Lt=function(t){return l.Bt(t)},this.dt=function(t){return l.pt(t)},this.Nt=function(t){return l.Ot(t)},h.addEventListener("pointerdown",this.Lt,!1),h.addEventListener("pointerup",this.dt,!1),h.addEventListener("pointermove",this.Nt,!1),this.zt=function(){return l.Et()},this.at.registerBeforeRender(this.zt)}return t.prototype.ot=function(){if(!this.V&&(null==this.et.rotationQuaternion||void 0==this.et.rotationQuaternion))throw"Error: Eulerian is set to false but the mesh's rotationQuaternion is not set."},t.prototype.Et=function(){this.Yt.position=this.et.getAbsolutePivotPoint(),this.bt(),this.xt(),this.t?(this.Yt.getWorldMatrix().invertToRef(this.A),c.TransformCoordinatesToRef(this.lt.position,this.A,this.L),this.yt.lookAt(this.L,0,0,0,o.LOCAL)):(this.lt.position.subtractToRef(this.Yt.position,this.L),this.yt.lookAt(this.lt.position,0,0,0,o.WORLD)),this._?this.Ct():this.$?this.gt(this.Rt,this.St,this.Tt):this.tt&&this.gt(this.kt,this.Pt,this.Qt)},t.prototype.bt=function(){if(this.t)if(null==this.et.parent)if(this.V){var t=this.et.rotation;f.RotationYawPitchRollToRef(t.y,t.x,t.z,this.Yt.rotationQuaternion)}else this.Yt.rotationQuaternion.copyFrom(this.et.rotationQuaternion);else{if(this.jt(this.et))return;this.et.getWorldMatrix().getRotationMatrixToRef(this.rt),f.FromRotationMatrixToRef(this.rt,this.Yt.rotationQuaternion)}},t.prototype.jt=function(t){if(null==t.parent)return!1;for(;null!=t.parent;){if(t.parent.scaling.x!=t.parent.scaling.y||t.parent.scaling.y!=t.parent.scaling.z)return!0;t=t.parent}return!1},t.prototype.xt=function(){this.Yt.position.subtractToRef(this.lt.position,this.p),c.FromFloatArrayToRef(this.lt.getWorldMatrix().asArray(),8,this.N);var t=c.Dot(this.p,this.N)/this.N.length(),i=Math.abs(t/this.B);c.FromFloatsToRef(i,i,i,this.Yt.scaling)},t.prototype.Ct=function(){var t=Math.atan(this.L.y/this.L.z);this.L.z>=0?this.qt.rotation.x=-t:this.qt.rotation.x=-t-Math.PI;var i=Math.atan(this.L.x/this.L.z);this.L.z>=0?this.Dt.rotation.y=i:this.Dt.rotation.y=i+Math.PI;var h=Math.atan(this.L.x/this.L.y);this.L.y>=0?this.Ft.rotation.z=-h:this.Ft.rotation.z=-h-Math.PI},t.prototype.gt=function(t,i,h){var s=this.L;t.rotation.x=0,t.rotation.y=0,t.rotation.z=0,i.rotation.x=0,i.rotation.y=0,i.rotation.z=0,h.rotation.x=0,h.rotation.y=0,h.rotation.z=0,s.x<=0&&s.y>=0&&s.z>=0?(t.rotation.z=3.14,h.rotation.y=3.14):s.x<=0&&s.y>=0&&s.z<=0?(t.rotation.y=3.14,i.rotation.y=3.14,h.rotation.y=3.14):s.x>=0&&s.y>=0&&s.z<=0?(t.rotation.x=3.14,i.rotation.y=3.14):s.x>=0&&s.y<=0&&s.z>=0?(i.rotation.z=3.14,h.rotation.x=3.14):s.x<=0&&s.y<=0&&s.z>=0?(t.rotation.z=3.14,i.rotation.z=3.14,h.rotation.z=3.14):s.x<=0&&s.y<=0&&s.z<=0?(t.rotation.y=3.14,i.rotation.x=3.14,h.rotation.z=3.14):s.x>=0&&s.y<=0&&s.z<=0&&(t.rotation.x=3.14,i.rotation.x=3.14,h.rotation.x=3.14)},t.prototype.switchTo=function(t,i){t.computeWorldMatrix(!0),this.et=t,null!=i&&(this.V=i),this.ot(),this.wt(t),this.ct=new M(t,10),this.refreshBoundingInfo()},t.prototype.setUndoCount=function(t){this.ct.setCapacity(t)},t.prototype.undo=function(){var t=this.ct.undo();this.et.computeWorldMatrix(!0),this.wt(this.et),this.Gt(t),this.Ht(t),this.It(t)},t.prototype.redo=function(){var t=this.ct.redo();this.et.computeWorldMatrix(!0),this.wt(this.et),this.Gt(t),this.Ht(t),this.It(t)},t.prototype.detach=function(){this.ft.removeEventListener("pointerdown",this.Lt,!1),this.ft.removeEventListener("pointerup",this.dt,!1),this.ft.removeEventListener("pointermove",this.Nt,!1),this.at.unregisterBeforeRender(this.zt),this.removeAllActionListeners(),this.Jt()},t.prototype.hide=function(){this.C=!0,this.$?(this.O="T",this.disableTranslation()):this._?(this.O="R",this.disableRotation()):this.tt&&(this.O="S",this.disableScaling()),this.Kt()},t.prototype.Kt=function(){this.Ut.visibility=0,this.Vt.visibility=0,this.Wt.visibility=0},t.prototype.$t=function(){this.Ut.visibility=this.M,this.Vt.visibility=this.M,this.Wt.visibility=this.M},t.prototype.show=function(){this.C=!1,this.$t(),"T"==this.O?this.enableTranslation():"R"==this.O?this.enableRotation():"S"==this.O&&this.enableScaling()},t.prototype.isHidden=function(){return this.C},t.prototype.Jt=function(){this.Yt.dispose(),this._t(),this.ct=null},t.prototype.addActionListener=function(t){this.g=t},t.prototype.removeActionListener=function(){this.g=null},t.prototype.addActionStartListener=function(t){this.R=t},t.prototype.removeActionStartListener=function(){this.R=null},t.prototype.addActionEndListener=function(t){this.S=t},t.prototype.removeActionEndListener=function(){this.S=null},t.prototype.removeAllActionListeners=function(){this.g=null,this.R=null,this.S=null},t.prototype.Bt=function(t){var i=this;if(t.preventDefault(),this.T=!0,0==t.button){var h=this.at.pick(this.at.pointerX,this.at.pointerY,function(t){if(i.$){if(t==i.ti||t==i.ii||t==i.hi||t==i.Rt||t==i.St||t==i.Tt||t==i.si)return!0}else if(i._){if(t==i.qt||t==i.Dt||t==i.Ft||t==i.ni)return!0}else if(i.tt&&(t==i.ui||t==i.ri||t==i.ei||t==i.kt||t==i.Pt||t==i.Qt||t==i.li))return!0;return!1},null,this.lt);if(h.hit){this.fi=h.pickedMesh;var s=this.fi.getChildren();s.length>0?s[0].visibility=this.M:this.fi.visibility=this.M;var n=this.fi.name;"X"==n?this.oi.visibility=1:"Y"==n?this.ai.visibility=1:"Z"==n?this.ci.visibility=1:"XZ"==n?(this.oi.visibility=1,this.ci.visibility=1):"ZY"==n?(this.ci.visibility=1,this.ai.visibility=1):"YX"==n?(this.ai.visibility=1,this.oi.visibility=1):"ALL"==n&&(this.oi.visibility=1,this.ai.visibility=1,this.ci.visibility=1),this.vi(!0),this.Mi=this.wi(this.fi),null!=this.Mi?this.Yi=this.Xi():this.Yi=null,window.setTimeout(function(t,h){return i.Zi(t,h)},0,this.lt,this.ft)}}},t.prototype.vi=function(t){this.P=t,t?(this.Ai(),this.Li==i.ROT&&(this.W=0),this.Gt(this.Li)):this.It(this.Li)},t.prototype.isEditing=function(){return this.P},t.prototype.Zi=function(t,i){var h=i;t.detachControl(h)},t.prototype.isPointerOver=function(){return this.k},t.prototype.Bi=function(){var t=this,i=this.at.pick(this.at.pointerX,this.at.pointerY,function(i){if(t.$){if(i==t.ti||i==t.ii||i==t.hi||i==t.Rt||i==t.St||i==t.Tt||i==t.si)return!0}else if(t._){if(i==t.qt||i==t.Dt||i==t.Ft||i==t.ni)return!0}else if(t.tt&&(i==t.ui||i==t.ri||i==t.ei||i==t.kt||i==t.Pt||i==t.Qt||i==t.li))return!0;return!1},null,this.lt);if(i.hit){if(i.pickedMesh!=this.di){if(this.k=!0,this.pi(),this.di=i.pickedMesh,this._)this.Ni=this.di.getChildren()[0].color,this.di.getChildren()[0].color=n.White();else{var h=this.di.getChildren();h.length>0?(this.Oi=h[0].material,h[0].material=this.zi):(this.Oi=this.di.material,this.di.material=this.zi)}"X"==this.di.name?this.Ut.color=n.White():"Y"==this.di.name?this.Vt.color=n.White():"Z"==this.di.name&&(this.Wt.color=n.White())}}else this.k=!1,null!=this.di&&(this.Ei(this.di),this.di=null)},t.prototype.pi=function(){null!=this.di&&(this.di.visibility=0,this.Ei(this.di))},t.prototype.Ei=function(t){switch(t.name){case"X":this.Ut.color=n.Red();break;case"Y":this.Vt.color=n.Green();break;case"Z":this.Wt.color=n.Blue()}if(this._)t.getChildren()[0].color=this.Ni;else{var i=t.getChildren();i.length>0?i[0].material=this.Oi:t.material=this.Oi}},t.prototype.pt=function(t){this.T=!1,this.P&&(this.lt.attachControl(this.ft),this.vi(!1),this.bi(),null!=this.di&&(this.Ei(this.di),this.di=null),this.ct.add(this.Li))},t.prototype.Ai=function(){this.$?this.Li=i.TRANS:this._?this.Li=i.ROT:this.tt&&(this.Li=i.SCALE)},t.prototype.Ht=function(t){null!=this.g&&this.g(t)},t.prototype.Gt=function(t){null!=this.R&&this.R(t)},t.prototype.It=function(t){null!=this.S&&this.S(t)},t.prototype.Ot=function(t){if(this.T){if(this.P&&null!=this.Yi){var i=this.Xi();if(null!=i){if(this._)this.xi(this.et,this.fi,i,this.Yi);else{var h=i.subtract(this.Yi);if(0==h.x&&0==h.y&&0==h.z)return;this.$?this.yi(h):this.tt&&this.t&&this.Ci(h)}this.Yi=i,this.Ht(this.Li)}}}else this.Bi()},t.prototype.wi=function(t){var i=t.name;if(this.$||this.tt){if("XZ"==i)return this.gi;if("ZY"==i)return this.mi;if("YX"==i)return this.Ri;if("ALL"==i)return this.yt;this.Yt.getWorldMatrix().invertToRef(this.A),c.TransformCoordinatesToRef(this.lt.position,this.A,this.L);var h=this.L;if("X"===i)return Math.abs(h.y)>Math.abs(h.z)?this.gi:this.Ri;if("Z"===i)return Math.abs(h.y)>Math.abs(h.x)?this.gi:this.mi;if("Y"===i)return Math.abs(h.z)>Math.abs(h.x)?this.Ri:this.mi}else{if(!this._)return null;switch(this.j=!1,this.Yt.getWorldMatrix().invertToRef(this.A),c.TransformCoordinatesToRef(this.lt.position,this.A,this.L),h=this.L,i){case"X":return Math.abs(h.x)<.2?(this.j=!0,this.yt):this.mi;case"Y":return Math.abs(h.y)<.2?(this.j=!0,this.yt):this.gi;case"Z":return Math.abs(h.z)<.2?(this.j=!0,this.yt):this.Ri;default:return this.yt}}},t.prototype.yi=function(t){null!=this.et.parent&&this.jt(this.et)?this.wt(this.Yt):this.wt(this.et);var i=this.fi.name;"ALL"==i?this.q=t:(this.q.x=0,this.q.y=0,this.q.z=0,"X"!=i&&"XZ"!=i&&"YX"!=i||(this.t?this.q.x=c.Dot(t,this.J)/this.J.length():this.q.x=t.x),"Y"!=i&&"ZY"!=i&&"YX"!=i||(this.t?this.q.y=c.Dot(t,this.K)/this.K.length():this.q.y=t.y),"Z"!=i&&"XZ"!=i&&"ZY"!=i||(this.t?this.q.z=c.Dot(t,this.U)/this.U.length():this.q.z=t.z)),this.Si(this.et,this.q,this.t),this.Ti&&(this.et.position.x=Math.max(this.et.position.x,this.Ti.x),this.et.position.y=Math.max(this.et.position.y,this.Ti.y),this.et.position.z=Math.max(this.et.position.z,this.Ti.z)),this.ki&&(this.et.position.x=Math.min(this.et.position.x,this.ki.x),this.et.position.y=Math.min(this.et.position.y,this.ki.y),this.et.position.z=Math.min(this.et.position.z,this.ki.z)),this.et.computeWorldMatrix(!0)},t.prototype.Si=function(t,i,h){if(this.i){var s=!1;if(this.D.addInPlace(i),Math.abs(this.D.x)>this.ht.x&&(this.D.x>0?i.x=this.ht.x:i.x=-this.ht.x,s=!0),Math.abs(this.D.y)>this.ht.y&&(this.D.y>0?i.y=this.ht.y:i.y=-this.ht.y,s=!0),Math.abs(this.D.z)>this.ht.z&&(this.D.z>0?i.z=this.ht.z:i.z=-this.ht.z,s=!0),!s)return;Math.abs(i.x)!==this.ht.x&&(i.x=0),Math.abs(i.y)!==this.ht.y&&(i.y=0),Math.abs(i.z)!==this.ht.z&&(i.z=0),c.FromFloatsToRef(0,0,0,this.D),s=!1}h?(this.J.normalizeToRef(this.st),this.K.normalizeToRef(this.nt),this.U.normalizeToRef(this.ut),this.et.translate(this.st,i.x,o.WORLD),this.et.translate(this.nt,i.y,o.WORLD),this.et.translate(this.ut,i.z,o.WORLD)):null==this.et.parent?this.et.position.addInPlace(i):this.et.setAbsolutePosition(i.addInPlace(this.et.absolutePosition))},t.prototype.Ci=function(t){this.wt(this.et),this.I.x=0,this.I.y=0,this.I.z=0;var i=this.fi.name;"X"!=i&&"XZ"!=i&&"YX"!=i||(this.I.x=c.Dot(t,this.J)/this.J.length(),this.et.scaling.x<0&&(this.I.x=-this.I.x)),"Y"!=i&&"ZY"!=i&&"YX"!=i||(this.I.y=c.Dot(t,this.K)/this.K.length(),this.et.scaling.y<0&&(this.I.y=-this.I.y)),"Z"!=i&&"XZ"!=i&&"ZY"!=i||(this.I.z=c.Dot(t,this.U)/this.U.length(),this.et.scaling.z<0&&(this.I.z=-this.I.z));var h=this.vt;if(this.I.x=this.I.x/h.x,this.I.y=this.I.y/h.y,this.I.z=this.I.z/h.z,"ALL"==i){var s=c.Dot(t,this.lt.upVector);s/=Math.max(h.x,h.y,h.z),this.I.copyFromFloats(s,s,s)}else{var n=!1;"XZ"==i?(n=!0,Math.abs(this.I.x)>Math.abs(this.I.z)?this.I.z=this.I.x:this.I.x=this.I.z):"ZY"==i?(n=!0,Math.abs(this.I.z)>Math.abs(this.I.y)?this.I.y=this.I.z:this.I.z=this.I.y):"YX"==i&&(n=!0,Math.abs(this.I.y)>Math.abs(this.I.x)?this.I.x=this.I.y:this.I.y=this.I.x),n&&(this.Yt.position.subtractToRef(this.lt.position,this.p),s=c.Dot(t,this.p),this.I.x=Math.abs(this.I.x),this.I.y=Math.abs(this.I.y),this.I.z=Math.abs(this.I.z),s>0?(this.et.scaling.x>0&&(this.I.x=-this.I.x),this.et.scaling.y>0&&(this.I.y=-this.I.y),this.et.scaling.z>0&&(this.I.z=-this.I.z)):(this.et.scaling.x<0&&(this.I.x=-this.I.x),this.et.scaling.y<0&&(this.I.y=-this.I.y),this.et.scaling.z<0&&(this.I.z=-this.I.z)))}this.Pi(this.et,this.I),this.Qi&&(this.et.scaling.x=Math.max(this.et.scaling.x,this.Qi.x),this.et.scaling.y=Math.max(this.et.scaling.y,this.Qi.y),this.et.scaling.z=Math.max(this.et.scaling.z,this.Qi.z)),this.ji&&(this.et.scaling.x=Math.min(this.et.scaling.x,this.ji.x),this.et.scaling.y=Math.min(this.et.scaling.y,this.ji.y),this.et.scaling.z=Math.min(this.et.scaling.z,this.ji.z))},t.prototype.Pi=function(t,i){if(this.F){var h=!1;if(this.G.addInPlace(i),Math.abs(this.G.x)>this.H&&(i.x>0?i.x=this.H:i.x=-this.H,h=!0),Math.abs(this.G.y)>this.H&&(i.y>0?i.y=this.H:i.y=-this.H,h=!0),Math.abs(this.G.z)>this.H&&(i.z>0?i.z=this.H:i.z=-this.H,h=!0),!h)return;Math.abs(i.x)!==this.H&&0!==i.x&&(i.x=0),Math.abs(i.y)!==this.H&&0!==i.y&&(i.y=0),Math.abs(i.z)!==this.H&&0!==i.z&&(i.z=0),c.FromFloatsToRef(0,0,0,this.G),h=!1}t.scaling.addInPlace(i)},t.prototype.wt=function(t){var i=t.getWorldMatrix();c.FromFloatArrayToRef(i.m,0,this.J),c.FromFloatArrayToRef(i.m,4,this.K),c.FromFloatArrayToRef(i.m,8,this.U)},t.prototype.Mt=function(t){var i=t.getBoundingInfo().boundingBox,h=i.maximum.subtract(i.minimum);return 0==h.x&&(h.x=1),0==h.y&&(h.y=1),0==h.z&&(h.z=1),h},t.prototype.refreshBoundingInfo=function(){this.vt=this.Mt(this.et)},t.prototype.xi=function(t,i,h,n){this.t&&null!=this.et.parent&&this.jt(t)?this.wt(this.Yt):this.wt(t);var u,r=0;i==this.qt?u=this.t?this.J:s.X:i==this.Dt?u=this.t?this.K:s.Y:i==this.Ft&&(u=this.t?this.U:s.Z),this.Yt.position.subtractToRef(this.lt.position,this.p),this.j?(r=this.qi(n,h,this.lt.position,this.p,u),this.at.useRightHandedSystem&&(r=-r)):r=this.Di(n,h,t.getAbsolutePivotPoint(),this.p),this.h&&(this.W+=r,r=0,Math.abs(this.W)>=this.u&&(r=this.W>0?this.u:-this.u,this.W=0)),0!==r&&(this.p.normalize(),i==this.ni?t.rotate(this.p,-r,o.WORLD):(c.Dot(u,this.p)>=0&&(r=-r),t.rotate(u,r,o.WORLD)),this.V&&(t.rotation=t.rotationQuaternion.toEulerAngles(),t.rotationQuaternion=null),this.t&&null!=this.et.parent&&this.jt(t)&&(i==this.ni?this.Yt.rotate(this.p,-r,o.WORLD):this.Yt.rotate(u,r,o.WORLD)))},t.prototype.Xi=function(){var t=this,i=this.at.pick(this.at.pointerX,this.at.pointerY,function(i){return i==t.Mi},null,this.lt);return i.hit?i.pickedPoint:null},t.prototype.bi=function(){this.oi.visibility=0,this.ai.visibility=0,this.ci.visibility=0},t.prototype.Fi=function(t){this.$&&(this.Gi.visibility=t,this.Hi.visibility=t,this.Ii.visibility=t,this.Ji.visibility=t,this.Ki.visibility=t,this.Ui.visibility=t,this.Vi.visibility=t),this._&&(this.Wi.visibility=t,this.$i.visibility=t,this._i.visibility=t,this.th.visibility=t),this.tt&&(this.ih.visibility=t,this.hh.visibility=t,this.sh.visibility=t,this.nh.visibility=t,this.uh.visibility=t,this.rh.visibility=t,this.eh.visibility=t)},t.prototype.getRotationQuaternion=function(){return this.Yt.rotationQuaternion},t.prototype.getPosition=function(){return this.Yt.position},t.prototype.isTranslationEnabled=function(){return this.$},t.prototype.enableTranslation=function(){null==this.ti&&(this.lh(),this.fh.parent=this.Yt),this.pi(),this.$||(this.Gi.visibility=this.M,this.Hi.visibility=this.M,this.Ii.visibility=this.M,this.Ji.visibility=this.M,this.Ki.visibility=this.M,this.Ui.visibility=this.M,this.Vi.visibility=this.M,this.$=!0,this.disableRotation(),this.disableScaling())},t.prototype.disableTranslation=function(){this.$&&(this.Gi.visibility=0,this.Hi.visibility=0,this.Ii.visibility=0,this.Ji.visibility=0,this.Ki.visibility=0,this.Ui.visibility=0,this.Vi.visibility=0,this.$=!1)},t.prototype.isRotationEnabled=function(){return this._},t.prototype.returnEuler=function(t){this.V=t},t.prototype.enableRotation=function(){null==this.oh&&(this.ah(),this.oh.parent=this.Yt),this.pi(),this._||(this.Wi.visibility=this.M,this.$i.visibility=this.M,this._i.visibility=this.M,this.th.visibility=this.M,this.vh.visibility=this.M,this._=!0,this.disableTranslation(),this.disableScaling())},t.prototype.disableRotation=function(){this._&&(this.Wi.visibility=0,this.$i.visibility=0,this._i.visibility=0,this.th.visibility=0,this.vh.visibility=0,this._=!1)},t.prototype.isScalingEnabled=function(){return this.tt},t.prototype.enableScaling=function(){null==this.ui&&(this.Mh(),this.wh.parent=this.Yt),this.pi(),this.tt||(this.ih.visibility=this.M,this.hh.visibility=this.M,this.sh.visibility=this.M,this.nh.visibility=this.M,this.uh.visibility=this.M,this.rh.visibility=this.M,this.eh.visibility=this.M,this.tt=!0,this.disableTranslation(),this.disableRotation())},t.prototype.disableScaling=function(){this.tt&&(this.ih.visibility=0,this.hh.visibility=0,this.sh.visibility=0,this.nh.visibility=0,this.uh.visibility=0,this.rh.visibility=0,this.eh.visibility=0,this.tt=!1)},t.prototype.setScaleBounds=function(t,i){this.Qi=t||null,this.ji=i||null,null!=this.Qi&&(0==this.Qi.x&&(this.Qi.x=1e-8),0==this.Qi.y&&(this.Qi.y=1e-8),0==this.Qi.z&&(this.Qi.z=1e-8))},t.prototype.removeScaleBounds=function(){this.Qi=null,this.ji=null},t.prototype.setTransBounds=function(t,i){this.Ti=t||null,this.ki=i||null},t.prototype.removeTransBounds=function(){this.Ti=null,this.ki=null},t.prototype.setRotBounds=function(t,i){this.Yh=t||null,this.Xh=i||null},t.prototype.removeRotBounds=function(){this.Yh=null,this.Xh=null},t.prototype.Zt=function(){var t=new r("guideCtl",this.at);this.oi=r.CreateLines("bxAxis",[new c(-100,0,0),new c(100,0,0)],this.at),this.ai=r.CreateLines("byAxis",[new c(0,-100,0),new c(0,100,0)],this.at),this.ci=r.CreateLines("bzAxis",[new c(0,0,-100),new c(0,0,100)],this.at),this.oi.isPickable=!1,this.ai.isPickable=!1,this.ci.isPickable=!1,this.oi.parent=t,this.ai.parent=t,this.ci.parent=t,this.oi.color=n.Red(),this.ai.color=n.Green(),this.ci.color=n.Blue(),this.bi();var i=this.l*this.o*.75;return this.Ut=r.CreateLines("xAxis",[new c(0,0,0),new c(i,0,0)],this.at),this.Vt=r.CreateLines("yAxis",[new c(0,0,0),new c(0,i,0)],this.at),this.Wt=r.CreateLines("zAxis",[new c(0,0,0),new c(0,0,i)],this.at),this.Ut.isPickable=!1,this.Vt.isPickable=!1,this.Wt.isPickable=!1,this.Ut.parent=t,this.Vt.parent=t,this.Wt.parent=t,this.Ut.color=n.Red(),this.Vt.color=n.Green(),this.Wt.color=n.Blue(),this.Ut.renderingGroupId=1,this.Vt.renderingGroupId=1,this.Wt.renderingGroupId=1,t},t.prototype.At=function(){this.yt=r.CreatePlane("pALL",5,this.at),this.gi=r.CreatePlane("pXZ",5,this.at),this.mi=r.CreatePlane("pZY",5,this.at),this.Ri=r.CreatePlane("pYX",5,this.at),this.yt.isPickable=!1,this.gi.isPickable=!1,this.mi.isPickable=!1,this.Ri.isPickable=!1,this.yt.visibility=0,this.gi.visibility=0,this.mi.visibility=0,this.Ri.visibility=0,this.yt.renderingGroupId=1,this.gi.renderingGroupId=1,this.mi.renderingGroupId=1,this.Ri.renderingGroupId=1,this.yt.lookAt(this.lt.position),this.gi.rotate(s.X,1.57),this.mi.rotate(s.Y,1.57);var t=new r("pickPlanes",this.at);return this.yt.parent=t,this.gi.parent=t,this.mi.parent=t,this.Ri.parent=t,t},t.prototype.lh=function(){var t=2*this.v*this.o,i=this.l*this.o;this.fh=new r("tarnsCtl",this.at),this.ti=this.Zh(t/2,i),this.ti.name="X",this.ii=this.ti.clone("Y"),this.hi=this.ti.clone("Z"),this.Rt=e.CreatePlane("XZ",{size:2*t},this.at),this.St=e.CreatePlane("ZY",{size:2*t},this.at),this.Tt=e.CreatePlane("YX",{size:2*t},this.at),this.Rt.rotation.x=1.57,this.St.rotation.y=-1.57,this.Rt.position.x=t,this.Rt.position.z=t,this.St.position.z=t,this.St.position.y=t,this.Tt.position.y=t,this.Tt.position.x=t,this.Rt.bakeCurrentTransformIntoVertices(),this.St.bakeCurrentTransformIntoVertices(),this.Tt.bakeCurrentTransformIntoVertices(),this.si=r.CreateBox("ALL",2*t,this.at),this.ti.parent=this.fh,this.ii.parent=this.fh,this.hi.parent=this.fh,this.Rt.parent=this.fh,this.St.parent=this.fh,this.Tt.parent=this.fh,this.si.parent=this.fh,this.ti.rotation.y=1.57,this.ii.rotation.x-=1.57,this.ti.visibility=0,this.ii.visibility=0,this.hi.visibility=0,this.Rt.visibility=0,this.St.visibility=0,this.Tt.visibility=0,this.si.visibility=0,this.ti.isPickable=!1,this.ii.isPickable=!1,this.hi.isPickable=!1,this.Rt.isPickable=!1,this.St.isPickable=!1,this.Tt.isPickable=!1,this.si.isPickable=!1;var h=i/5,s=t;this.Gi=r.CreateCylinder("tEndX",h,0,s,6,1,this.at),this.Hi=this.Gi.clone("tEndY"),this.Ii=this.Gi.clone("tEndZ"),this.Ji=this.Ah("XZ",1.75*s,this.at),this.Ki=this.Ji.clone("ZY"),this.Ui=this.Ji.clone("YX"),this.Vi=e.CreatePolyhedron("tEndAll",{type:1,size:s/2},this.at),this.Gi.rotation.x=1.57,this.Hi.rotation.x=1.57,this.Ii.rotation.x=1.57,this.Ki.rotation.z=1.57,this.Ui.rotation.x=-1.57,this.Ji.position.x=t,this.Ji.position.z=t,this.Ki.position.z=t,this.Ki.position.y=t,this.Ui.position.y=t,this.Ui.position.x=t,this.Gi.parent=this.ti,this.Hi.parent=this.ii,this.Ii.parent=this.hi,this.Ji.parent=this.Rt,this.Ki.parent=this.St,this.Ui.parent=this.Tt,this.Vi.parent=this.si,this.Gi.position.z=i-h/2,this.Hi.position.z=i-h/2,this.Ii.position.z=i-h/2,this.Gi.material=this.Lh,this.Hi.material=this.Bh,this.Ii.material=this.dh,this.Ji.material=this.Bh,this.Ki.material=this.Lh,this.Ui.material=this.dh,this.Vi.material=this.ph,this.Gi.renderingGroupId=2,this.Hi.renderingGroupId=2,this.Ii.renderingGroupId=2,this.Ji.renderingGroupId=2,this.Ki.renderingGroupId=2,this.Ui.renderingGroupId=2,this.Vi.renderingGroupId=2,this.Gi.isPickable=!1,this.Hi.isPickable=!1,this.Ii.isPickable=!1,this.Ji.isPickable=!1,this.Ki.isPickable=!1,this.Ui.isPickable=!1,this.Vi.isPickable=!1},t.prototype.Ah=function(t,i,h){var s=new l(i/2,-i/2).addLineTo(i/2,i/2).addLineTo(-i/2,i/2).addLineTo(i/2,-i/2);return new BABYLON.PolygonMeshBuilder(t,s,h).build()},t.prototype.setRotGuideFull=function(t){this.it=t?360:180,null!=this.oh&&(this.oh.dispose(),this.ni.dispose(),this.oh=null,this.enableRotation())},t.prototype.ah=function(){var t=this.l*this.o*2;this.oh=new r("rotCtl",this.at),this.qt=this.Nh(t/2,this.it),this.qt.name="X",this.Dt=this.Nh(t/2,this.it),this.Dt.name="Y",this.Ft=this.Nh(t/2,this.it),this.Ft.name="Z",this.ni=this.Nh(t/1.75,360),this.ni.name="ALL",this.qt.rotation.z=1.57,this.Ft.rotation.x=-1.57,this.qt.bakeCurrentTransformIntoVertices(),this.Ft.bakeCurrentTransformIntoVertices(),this.ni.rotation.x=1.57,this.qt.parent=this.oh,this.Dt.parent=this.oh,this.Ft.parent=this.oh,this.ni.parent=this.yt,this.qt.visibility=0,this.Dt.visibility=0,this.Ft.visibility=0,this.ni.visibility=0,this.qt.isPickable=!1,this.Dt.isPickable=!1,this.Ft.isPickable=!1,this.ni.isPickable=!1;var i=t;this.Wi=this.Oh(i/2,this.it,!1),this.$i=this.Wi.clone(""),this._i=this.Wi.clone(""),this.th=this.Oh(i/1.75,360,!1),this.vh=this.Oh(i/2,360,!1),this.Wi.parent=this.qt,this.$i.parent=this.Dt,this._i.parent=this.Ft,this.Wi.rotation.z=1.57,this._i.rotation.x=-1.57,this.th.parent=this.ni,this.vh.parent=this.ni,this.Wi.color=n.Red(),this.$i.color=n.Green(),this._i.color=n.Blue(),this.th.color=n.Yellow(),this.vh.color=n.Gray(),this.Wi.renderingGroupId=2,this.$i.renderingGroupId=2,this._i.renderingGroupId=2,this.th.renderingGroupId=2,this.vh.renderingGroupId=2,this.Wi.isPickable=!1,this.$i.isPickable=!1,this._i.isPickable=!1,this.th.isPickable=!1,this.vh.isPickable=!1},t.prototype.Zh=function(t,i){var h=[new c(t,t,0),new c(-t,t,0),new c(-t,-t,0),new c(t,-t,0),new c(t,t,0)],s=[new c(0,0,0),new c(0,0,i)];return r.ExtrudeShape("",h,s,1,0,2,this.at)},t.prototype.Oh=function(t,i,h){null===i&&(i=360);for(var s,n,u=[],e=3.14/180,l=0,f=0;f<=i;f+=5)s=t*Math.cos(f*e),n=90==f?t:270==f?-t:t*Math.sin(f*e),u[l]=new c(s,0,n),l++;if(h)for(t-=.04,f=0;f<=i;f+=5)s=t*Math.cos(f*e),n=90==f?t:270==f?-t:t*Math.sin(f*e),u[l]=new c(s,0,n),l++;return r.CreateLines("",u,this.at)},t.prototype.Nh=function(t,i){null===i&&(i=360);for(var h,s,n=[],u=0,e=0;e<=i;e+=30)h=t*Math.cos(e*(3.14/180)),s=90==e?t:270==e?-t:t*Math.sin(e*(3.14/180)),n[u]=new c(h,0,s),u++;return r.CreateTube("",n,this.v*this.o*2,3,null,BABYLON.Mesh.zh,this.at)},t.prototype.Mh=function(){var t=2*this.v*this.o,i=this.l*this.o;this.wh=new r("sCtl",this.at),this.ui=this.Zh(t/2,i),this.ui.name="X",this.ri=this.ui.clone("Y"),this.ei=this.ui.clone("Z"),this.kt=e.CreatePlane("XZ",{size:2*t},this.at),this.Pt=e.CreatePlane("ZY",{size:2*t},this.at),this.Qt=e.CreatePlane("YX",{size:2*t},this.at),this.kt.rotation.x=1.57,this.Pt.rotation.y=-1.57,this.kt.position.x=t,this.kt.position.z=t,this.Pt.position.z=t,this.Pt.position.y=t,this.Qt.position.y=t,this.Qt.position.x=t,this.kt.bakeCurrentTransformIntoVertices(),this.Pt.bakeCurrentTransformIntoVertices(),this.Qt.bakeCurrentTransformIntoVertices(),this.li=r.CreateBox("ALL",2*t,this.at),this.ui.parent=this.wh,this.ri.parent=this.wh,this.ei.parent=this.wh,this.li.parent=this.wh,this.kt.parent=this.wh,this.Pt.parent=this.wh,this.Qt.parent=this.wh,this.ui.rotation.y=1.57,this.ri.rotation.x-=1.57,this.ui.visibility=0,this.ri.visibility=0,this.ei.visibility=0,this.kt.visibility=0,this.Pt.visibility=0,this.Qt.visibility=0,this.li.visibility=0,this.ui.isPickable=!1,this.ri.isPickable=!1,this.ei.isPickable=!1,this.kt.isPickable=!1,this.Pt.isPickable=!1,this.Qt.isPickable=!1,this.li.isPickable=!1;var h=t;this.ih=r.CreateBox("",h,this.at),this.hh=this.ih.clone(""),this.sh=this.ih.clone(""),this.nh=this.Ah("XZ",1.75*h,this.at),this.uh=this.nh.clone("ZY"),this.rh=this.nh.clone("YX"),this.eh=e.CreatePolyhedron("sEndAll",{type:1,size:h/2},this.at),this.uh.rotation.z=1.57,this.rh.rotation.x=-1.57,this.nh.position.x=t,this.nh.position.z=t,this.uh.position.z=t,this.uh.position.y=t,this.rh.position.y=t,this.rh.position.x=t,this.ih.parent=this.ui,this.hh.parent=this.ri,this.sh.parent=this.ei,this.nh.parent=this.kt,this.uh.parent=this.Pt,this.rh.parent=this.Qt,this.eh.parent=this.li,this.ih.position.z=i-h/2,this.hh.position.z=i-h/2,this.sh.position.z=i-h/2,this.ih.material=this.Lh,this.hh.material=this.Bh,this.sh.material=this.dh,this.nh.material=this.Bh,this.uh.material=this.Lh,this.rh.material=this.dh,this.eh.material=this.ph,this.ih.renderingGroupId=2,this.hh.renderingGroupId=2,this.sh.renderingGroupId=2,this.nh.renderingGroupId=2,this.uh.renderingGroupId=2,this.rh.renderingGroupId=2,this.eh.renderingGroupId=2,this.ih.isPickable=!1,this.hh.isPickable=!1,this.sh.isPickable=!1,this.nh.isPickable=!1,this.uh.isPickable=!1,this.rh.isPickable=!1,this.eh.isPickable=!1},t.prototype.Eh=function(t){var i=c.Cross(this.J,this.K);return c.Dot(i,this.U)<0},t.prototype.setVisibility=function(t){this.M=t},t.prototype.setLocal=function(t){this.t!=t&&(this.t=t,t||(this.Yt.rotationQuaternion=f.Identity()))},t.prototype.isLocal=function(){return this.t},t.prototype.setTransSnap=function(t){this.i=t},t.prototype.setRotSnap=function(t){this.h=t},t.prototype.setScaleSnap=function(t){this.F=t},t.prototype.setTransSnapValue=function(t){this.ht.copyFromFloats(t,t,t),this.s=t},t.prototype.setRotSnapValue=function(t){this.u=t},t.prototype.setScaleSnapValue=function(t){this.H=t},t.prototype.qi=function(t,i,h,s,n){var u=c.Dot(s,n);n.scaleToRef(u,this.st),h.addToRef(this.st,this.nt);var r=this.nt;this.lt.getWorldMatrix().invertToRef(this.rt),c.TransformCoordinatesToRef(this.nt,this.rt,this.nt);var e=0;r.x>=0&&r.y>=0?e=1:r.x<=0&&r.y>=0?e=2:r.x<=0&&r.y<=0?e=3:r.x>=0&&r.y<=0&&(e=4),c.TransformCoordinatesToRef(t,this.rt,this.st),c.TransformCoordinatesToRef(i,this.rt,this.nt),this.nt.subtractInPlace(this.st);var l=this.nt,f=l.length(),o="";l.x>=0&&l.y>=0?o=l.x>=l.y?"r":"u":l.x<=0&&l.y>=0?o=-l.x>=l.y?"l":"u":l.x<=0&&l.y<=0?o=-l.x>=-l.y?"l":"d":l.x>=0&&l.y<=0&&(o=l.x>=-l.y?"r":"d");var a=0;return"d"==o?a=1==e||4==e?1:-1:"u"==o?a=1==e||4==e?-1:1:"r"==o?a=2==e||1==e?1:-1:"l"==o&&(a=2==e||1==e?-1:1),a*f},t.prototype.Di=function(t,i,h,s){t.subtractToRef(h,this.st),i.subtractToRef(h,this.nt),c.CrossToRef(this.st,this.nt,this.ut);var n=Math.asin(this.ut.length()/(this.st.length()*this.nt.length()));return c.Dot(this.ut,s)>0&&(n*=-1),n},t.prototype.Xt=function(i){this.Lh=t.bh("redMat",n.Red(),i),this.Bh=t.bh("greenMat",n.Green(),i),this.dh=t.bh("blueMat",n.Blue(),i),this.zi=t.bh("whiteMat",n.White(),i),this.ph=t.bh("whiteMat",n.Yellow(),i)},t.prototype._t=function(){this.Lh.dispose(),this.Bh.dispose(),this.dh.dispose(),this.zi.dispose(),this.ph.dispose()},t.bh=function(t,i,h){var s=new a(t,h);return s.emissiveColor=i,s.diffuseColor=n.Black(),s.specularColor=n.Black(),s.backFaceCulling=!1,s},t}();t.EditControl=v;var M=function(){function t(t,i){this.lastMax=10,this.acts=new Array,this.last=-1,this.current=-1,this.mesh=t,this.lastMax=i-1,this.add()}return t.prototype.setCapacity=function(t){0!=t?(this.lastMax=t-1,this.last=-1,this.current=-1,this.acts=new Array,this.add()):console.error("capacity should be more than zero")},t.prototype.add=function(t){void 0===t&&(t=null);var i=new w(this.mesh,t);this.current<this.last&&(this.acts.splice(this.current+1),this.last=this.current),this.last==this.lastMax?(this.acts.shift(),this.acts.push(i)):(this.acts.push(i),this.last++,this.current++)},t.prototype.undo=function(){if(this.current>0){var t=this.acts[this.current].getActionType();return this.current--,this.acts[this.current].perform(this.mesh),t}},t.prototype.redo=function(){if(this.current<this.last)return this.current++,this.acts[this.current].perform(this.mesh),this.acts[this.current].getActionType()},t}();t.ActHist=M;var w=function(){function t(t,i){this.xh=t.position.clone(),null==t.rotationQuaternion?(this.yh=null,this.Ch=t.rotation.clone()):(this.yh=t.rotationQuaternion.clone(),this.Ch=null),this.gh=t.scaling.clone(),this.mh=i}return t.prototype.getActionType=function(){return this.mh},t.prototype.perform=function(t){t.position.copyFrom(this.xh),null==t.rotationQuaternion?null!=this.Ch?t.rotation.copyFrom(this.Ch):t.rotation.copyFrom(this.yh.toEulerAngles()):null!=this.yh?t.rotationQuaternion.copyFrom(this.yh):t.rotationQuaternion.copyFrom(f.RotationYawPitchRoll(this.Ch.y,this.Ch.x,this.Ch.z)),t.scaling.copyFrom(this.gh)},t}();t.Act=w}((h=i.babylonjs||(i.babylonjs={})).component||(h.component={}))}(org||(org={}));